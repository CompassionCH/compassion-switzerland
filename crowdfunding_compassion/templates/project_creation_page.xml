<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!--        Creation page-->
        <template id="project_creation_view_template">
            <t t-set="title" t-if="not form.main_object">Project creation</t>
            <t t-set="title" t-if="form.main_object">Join
                <t t-esc="form.main_object.name"/>
            </t>
            <t t-set="header">
                <div class="row mt-5">
                    <div class="col-md-4 col-xl-2 center">
                        <img src="/crowdfunding_compassion/static/src/img/astronaut_600.jpg"
                             class="rounded-circle img-fluid"/>
                    </div>
                </div>
                <t t-if="not form.main_object">
                    <h1 class="blue uppercase">Create a new project</h1>
                    <h2>Two lines introduction.</h2>
                    <h2>Two lines introduction.</h2>
                </t>
                <t t-else="">
                    <h1 class="blue uppercase" t-esc="title"/>
                    <h2 t-field="form.main_object.description"/>
                </t>
                <div class="row">
                    <div class="col-md-2"/>
                    <div class="col-md-8">
                        <ul class="stepper stepper-horizontal">
                            <t t-if="page == 1">
                                <t t-set="class1">active</t>
                                <t t-set="class2">inactive</t>
                                <t t-set="class3">inactive</t>
                            </t>
                            <t t-if="page == 2">
                                <t t-set="class1">completed</t>
                                <t t-set="class2">active</t>
                                <t t-set="class3">inactive</t>
                            </t>
                            <t t-if="page == 3">
                                <t t-set="class1">completed</t>
                                <t t-set="class2">completed</t>
                                <t t-set="class3">active</t>
                            </t>
                            <!-- First Step -->
                            <li t-att-class="class1">
                                <a t-att-href="'/projects/create/' if page != 1 else '#!'">
                                    <span class="circle">1</span>
                                    <span class="label">Your project</span>
                                </a>
                            </li>

                            <!-- Second Step -->
                            <li t-att-class="class2">
                                <a t-att-href="'/projects/create/page/2' if page >= 2 else '#!'">
                                    <span class="circle">2</span>
                                    <span class="label" t-if="not product">Your fund</span>
                                    <span class="label" t-if="product">Your goal</span>
                                </a>
                            </li>

                            <!-- Third Step -->
                            <li t-att-class="class3">
                                <a t-att-href="'/projects/create/page/2' if page >= 3 else '#!'">
                                    <span class="circle">3</span>
                                    <span class="label">Your personal information</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-2"/>
                </div>
            </t>
            <t t-call="crowdfunding_compassion.layout">
                <section class="blue py-3 mb-3 text-center">
                    <div t-if="page == 1">
                        <h3 class="center-text uppercase">Describe your project</h3>
                        <h5 class="center-text">
                            Here you can describe your project, why you are engaged and set
                            up
                            some
                            details
                        </h5>
                    </div>
                    <div t-if="page == 2">
                        <h3 class="center-text uppercase" t-if="not product">Choose for what you want to invest in</h3>
                        <h3 class="center-text uppercase" t-if="product">Set your personal goal</h3>
                        <h5 class="center-text" t-if="not product">
                            Here you can choose the fund to associate to your project, and/or you can decide if you also
                            want to promote child sponsorship.
                        </h5>
                        <h5 class="center-text" t-if="product">
                            Here you can choose if you want to collect money for
                            <t t-esc="product.crowdfunding_impact_text_active"/>
                            and/or you can decide if you also
                            want to promote child sponsorship.
                        </h5>
                    </div>
                    <div t-if="page == 3">
                        <h3 class="center-text uppercase">Your personal information</h3>
                        <h5 class="center-text">
                            Please enter your personal information below. You can always modify this later on your
                            profile.
                        </h5>
                    </div>
                </section>

                <t t-if="page == 2">
                    <!-- Fund selection template -->
                    <div class="container">
                        <!-- If no cause is selected for the project we display the funds available. -->
                        <t t-if="not product">
                            <h3 class="center-text my-3">I want to invest in one of the following cause</h3>
                            <div class="row">
                                <t t-set="nb_fund" t-value="len(funds)"/>
                                <div class="col-lg-1" t-if="nb_fund &lt; 4"/>
                                <div class="col-sm-2" t-if="nb_fund &lt; 3"/>
                                <t t-foreach="funds" t-as="fund">
                                    <div class="col-xs-6 col-sm-4 col-lg-3">
                                        <div class="card border-0">
                                            <img t-attf-src="data:image;base64,#{fund.image_medium}"
                                                 class="d-block mx-auto" t-if="fund.image"/>
                                            <div class="card-body">
                                                <h3 class="blue card-title center-text" t-field="fund.name"/>
                                                <p t-field="fund.crowdfunding_description"
                                                   class="card-text mb-3 center-text"/>
                                                <input type="radio" t-attf-id="product-id-#{fund_index}" name="product"
                                                       class="card-input-element d-none" t-att-value="fund.id"/>
                                                <a t-attf-id="product-choose-#{fund_index}"
                                                   class="btn btn-primary center">CHOOSE
                                                </a>
                                            </div>
                                        </div>
                                        <div t-attf-id="fund-settings-#{fund_index}" class="card bg-blue mb-5"
                                             style="display: none">
                                            <div class="card-body center-text">
                                                <div class="card-title">
                                                    <h4 t-field="fund.fund_selector_pre_description" class="white"/>
                                                    <input type="number" t-attf-id="fund-number-#{fund_index}"/>
                                                    <h4 t-field="fund.fund_selector_post_description" class="white"/>
                                                </div>
                                                <p class="card-text text-white">
                                                    <span class="white">Indicate the amount in the above box. 1</span>
                                                    <t t-esc="fund.crowdfunding_quantity_singular" class="white"/>
                                                    <span class="white">is equivalent to CHF</span>
                                                    <t t-esc="fund.standard_price" class="white"/>.-
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                                <div class="col-lg-1" t-if="nb_fund &lt; 4"/>
                                <div class="col-sm-2" t-if="nb_fund &lt; 3"/>
                            </div>
                            <div class="center text-center">
                                <input type="checkbox" name="no-product" id="no-product"/>
                                <span>I don't want to choose a cause. I only want to propose children sponsorship.
                                </span>
                            </div>
                        </t>
                        <!-- If a cause is set, it means a participant is joining and must only set his personal goal. -->
                        <t t-if="product">
                            <h3 class="center-text my-3">By joining the project, I will invest in the following cause
                            </h3>
                            <div class="center center-text">
                                <img t-attf-src="data:image;base64,#{product.image_medium}" class="d-block mx-auto"
                                     t-if="product.image_medium"/>
                                <h3 class="blue center-text" t-field="product.name"/>
                                <p t-field="product.crowdfunding_description" class="mb-3"/>
                                <input type="radio" id="product-id-1" name="product" class="d-none"
                                       t-att-value="product.id"/>
                                <h4 t-field="product.fund_selector_pre_description"/>
                                <input type="number" id="fund-number-1"/>
                                <h4 t-field="product.fund_selector_post_description"/>
                                <p>
                                    <span>Indicate the amount in the above box. 1</span>
                                    <span t-esc="product.crowdfunding_quantity_singular"/>
                                    <span>is equivalent to CHF</span>
                                    <span t-esc="product.standard_price"/>.-
                                </p>
                            </div>
                            <div class="center text-center">
                                <input type="checkbox" name="no-product" id="no-product"/>
                                <span>I don't want to promote the cause. I only want to propose children sponsorship.
                                </span>
                            </div>
                        </t>
                        <hr class="blue my-3"/>
                        <h3 class="center-text">I want children to be released from extreme poverty</h3>
                        <div class="row my-3">
                            <div class="col-md-3"/>
                            <div class="col-md-2 text-right">
                                <img src="/crowdfunding_compassion/static/src/img/defaut_fund_icon.png" width="100px"/>
                            </div>
                            <div class="col-md-4">
                                <h3 class="blue">Sponsor children</h3>
                                <p>If you want to propose children sponsorship, please indicate the number of children
                                    in
                                    the box below. One sponsorship is equivalent to CHF 42.-/month
                                </p>
                                <input type="number" id="number-sponsorships" name="number-sponsorships"/>
                                <span>children</span>
                            </div>
                            <div class="col-md-3"/>
                        </div>
                    </div>

                </t>
                <div t-attf-class="#{form.form_wrapper_css_klass} center">
                    <t t-raw="form.form_render()"/>
                </div>
            </t>
        </template>

        <record id="project_creation_page" model="website.page">
            <field name="url">/projects/create</field>
            <field name="website_indexed" eval="True"/>
            <field name="website_published">True</field>
            <field name="website_id" ref="crowdfunding_compassion.crowdfunding_website"/>
            <field name="name">Project Creation</field>
            <field name="type">qweb</field>
        </record>

        <record id="project_creation_menu" model="website.menu">
            <field name="url">/projects/create</field>
            <field name="name">Project creation menu</field>
            <field name="page_id" ref="project_creation_page"/>
            <field name="parent_id" ref="website.main_menu"/>
            <field name="sequence" type="int">85</field>
            <field name="website_id" ref="crowdfunding_compassion.crowdfunding_website"/>
        </record>


        <!-- Confirmation page -->
        <template id="project_creation_confirmation_view_template">
            <t t-call="crowdfunding_compassion.layout">
                <t t-set="title" t-value="project.name"/>
                <div id="confirmation" class="text-center">
                    <br/>
                    <br/>
                    <h3>
                        Thank you for
                        <span t-if="is_new">launching</span>
                        <span t-if="not is_new">joining</span>
                        a project ! You will receive an email with all the necessary
                        information
                    </h3>
                    <br/>
                    <br/>
                </div>
            </t>
        </template>
        <record id="project_creation_confirmation_page" model="website.page">
            <field name="url">/projects/confirm</field>
            <field name="website_indexed" eval="True"/>
            <field name="website_published">True</field>
            <field name="website_id" ref="crowdfunding_compassion.crowdfunding_website"/>
            <field name="name">Project Creation Confirmation</field>
            <field name="type">qweb</field>
        </record>
    </data>
</odoo>
