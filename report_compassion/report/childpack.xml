<odoo>
    <report id="report_childpack_full"
            model="compassion.child"
            string="Full Childpack"
            report_type="qweb-pdf"
            name="report_compassion.childpack_full"
            menu="False"
    />
    <record id="report_childpack_full" model="ir.actions.report.xml">
        <field name="paperformat_id" ref="paperformat_childpack"/>
    </record>

    <report id="report_childpack_small"
            model="compassion.child"
            string="Small Childpack"
            report_type="qweb-pdf"
            name="report_compassion.childpack_small"
            menu="False"
    />
    <record id="report_childpack_small" model="ir.actions.report.xml">
        <field name="paperformat_id" ref="paperformat_a4_childpack"/>
    </record>

    <report id="report_childpack_mini"
            model="compassion.child"
            string="Mini Childpack"
            report_type="qweb-pdf"
            name="report_compassion.childpack_mini"
            menu="False"
    />
    <record id="report_childpack_mini" model="ir.actions.report.xml">
        <field name="paperformat_id" ref="paperformat_mini_childpack"/>
    </record>

    <template id="childpack_full">
        <t t-set="formMargin" t-value="124"/>
        <t t-call="report_compassion.childpack_small"/>
    </template>

    <template id="childpack_small">
        <t t-set="marginLeft" t-value="formMargin or 0"/>
        <t t-set="full" t-value="marginLeft > 0"/>
        <t t-set="small" t-value="not full"/>
        <t t-set="custom_css">
            .container {
                font-family: "tetriaLight";
                font-size: 8pt;
            }
            .local_id {
                font-family: "tetriaTab";
                position: absolute;
                margin-top: 65mm;
                margin-left: 56mm;
                width: 108mm;
                writing-mode:vertical-rl;
                -webkit-transform:rotate(-90deg);
                -moz-transform:rotate(-90deg);
                -o-transform: rotate(-90deg);
                -ms-transform:rotate(-90deg);
                transform: rotate(-90deg);
                white-space:nowrap;
            }
            #due_date {
                margin-right: 20mm;
            }
            .desc {
                position: absolute;
                margin-left: <t t-esc="marginLeft+7"/>mm;
                margin-top: 32mm;
                width: 130mm;
                height: 116mm;
                max-height: 116mm;
                font-size: 9pt;
                column-count: 2;
                -webkit-column-count: 2; /* Chrome, Safari, Opera */
                -moz-column-count: 2; /* Firefox */
            }
            .desc .left {
                width: 60mm;
                max-width: 100%;
            }
            .desc .right {
                width: 65mm;
                max-width: 100%;
                position: absolute;
                left: 65mm;
                top: 0mm;
            }
            .desc .left table {
                width: 60mm;
            }
            .desc .right table {
                width: 65mm;
            }
            .desc td {
                vertical-align: bottom;
                padding-bottom: 1.5mm;
            }
            .desc td:first-child {
                padding-right: 2mm;
                vertical-align: top;
                width: 50%;
            }
            h6 {
                font-family: "tetriaBlack";
                text-transform: uppercase;
                font-weight: bold;
            }
            .desc h6 {
                margin-top: 3mm;
                margin-bottom: 0mm;
            }
            .photo {
                position: absolute;
                <!-- Resolve shifts with small dossier -->
                <t t-if="small">
                    margin-left: 176mm;
                    margin-top: 45mm;
                </t>
                <t t-if="full">
                    margin-left: 300mm;
                    margin-top: 55mm;
                </t>
                width: 88mm;
                height: 112mm;
            }
            .photo img {
                max-width: 100%;
                max-height: 100%;
                margin: auto;
            }
            #child-ref {
                //width: 56mm;
                //text-align: center;
                font-size: small;
                font-family: "tetriaTab";
                margin-top: 2mm;
                margin-left: 6.5mm;
            }
            .summary {
                position: absolute;
                <!-- Resolve shifts with small dossier -->
                <t t-if="small">
                    margin-top: 179mm;
                    margin-left: 229mm;
                </t>
                <t t-if="full">
                    margin-top: 179mm;
                    margin-left: 352mm;
                </t>
            }
            .summary_field {
                position: relative;
                font-weight: bold;
                font-family: "tetriaBold";
                text-transform: uppercase;
                margin: 0mm;
            }
            .summary_field.name {
                font-size: 17pt;
                left: -7mm;
            }
            .summary_field.birthday {
                font-size: 15pt;
                top: -2pt;
            }
            .summary_field.country {
                font-size: 13pt;
                top: -1pt;
                left: -15mm;
            }
            .activities {
                display: none;
            }
            /* Comma separated lists */
            ul {
                margin: 0;
                padding: 0;
            }
            li {
                display: inline;
            }
            li:after {
                content: ", ";
            }
            li:last-child:after {
                content: "";
            }
            #background {
                <t t-if="small">
                    position: absolute;
                    width: 297mm;
                    height: 210mm;
                </t>
                <t t-if="full">
                    position: absolute;
                    width: 420mm;
                    height: 210mm;
                </t>
            }
            #background img {
                max-width: 100%;
                max-height: 100%;
                margin: auto;
            }
        </t>
        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="report_compassion.childpack_document" t-lang="lang"/>
            </t>
        </t>
    </template>

    <template id="childpack_document">
        <t t-set="o" t-value="o.with_context({'lang': lang})" />
        <div class="page">
            <t t-if="is_pdf">
                <div id="background">
                    <img t-attf-src="/report_compassion/static/img/{{ type }}/1904_dossier_{{ lang }}.jpg"/>
                </div>
            </t>
            <t t-call="report_compassion.style"/>
            <t t-if="formMargin">
                <div class="local_id">
                    <span>Childpack available until: </span><span t-raw="o.get_date('childpack_expiration')" id="due_date"/>
                    <span t-field="o.local_id"/>
                </div>
            </t>
            <div t-attf-class="desc {{'boy' if o.gender == 'M' else 'girl'}}">
                <div class="left">
                    <t t-raw="o.description_left"/>
                    <h6 t-if="o.project_id.description_left"><span t-field="o.project_title"/></h6>
                    <t t-raw="o.project_id.description_left"/>
                </div>
                <div class="right">
                    <t t-raw="o.description_right"/>
                    <h6 t-if="not o.project_id.description_left"><span t-field="o.project_title"/></h6>
                    <t t-raw="o.project_id.description_right"/>
                </div>
            </div>
            <div class="photo">
                <span t-field="o.fullshot" t-field-options='{"widget": "image"}'/>
                <p t-field="o.local_id" id="child-ref"/>
            </div>
            <div class="summary">
                <p t-field="o.preferred_name" class="summary_field name"/>
                <p t-raw="o.get_date('birthdate', 'date_short')" class="summary_field birthday"/>
                <p t-field="o.project_id.country_id.name" class="summary_field country"/>
            </div>
        </div>
    </template>

    <template id="childpack_mini">
        <t t-set="custom_css">
            .local_id {
                font-family: "tetriaTab";
                position: absolute;
                margin-top: 200mm;
                margin-left: 8mm;
                width: 25mm;
                font-size: 8pt;
            }
            h6 {
                font-family: "tetriaBlack";
                text-transform: uppercase;
            }
            .photo {
                position: absolute;
                margin-left: 115mm;
                margin-top: 54mm;
                width: 88mm;
                height: 125mm;
            }
            .photo img {
                max-width: 100%;
                max-height: 100%;
                margin: auto;
            }
            .summary {
                position: absolute;
                margin-left: 115mm;
                margin-top: 185mm;
                text-transform: uppercase;
                font-family: "tetriaTab";
                font-size: 15pt;
                color: #0054a6;
            }
            .summary .name {
                font-family: "tetriaBlack";
                font-weight: bold;
            }
            .summary .ref {
                color: black;
                font-size: 8pt;
            }
        </t>
        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="o">
                <div class="page">
                    <t t-call="report_compassion.style"/>
                    <div class="local_id">
                        <span t-field="o.local_id"/>
                    </div>
                    <div class="photo">
                        <span t-field="o.fullshot" t-field-options='{"widget": "image"}'/>
                    </div>
                    <div class="summary">
                        <span t-field="o.preferred_name" class="name"/>, <span t-field="o.age" class="age"/> years, <!-- keep space -->
                        <t t-if="o.gender == 'M'">
                            boy
                        </t>
                        <t t-if="o.gender == 'F'">
                            girl
                        </t>
                        <br/>
                        <span t-field="o.project_id.country_id.name"/>
                        <br/>
                        <span t-field="o.local_id" class="ref"/>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
