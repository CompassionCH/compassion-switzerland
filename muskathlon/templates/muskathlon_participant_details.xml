<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <!-- customize_show allow to disable or enable the customization in the website.
            TODO We should have a way to enable the customization only on wanted pages!
        -->
        <template id="participant_social_share" name="Remove default FB title" inherit_id="website.layout" active="True" customize_show="True" >
            <!-- This will remove the og:title feature that will be set manually in the header -->
            <xpath expr="//meta[contains(@property, 'og:')]" position="replace"/>
        </template>

        <template id="participant_details" name="Muskathlon participant page">
            <!-- Add social share information for Facebook and Twitter -->
            <t t-set="sport" t-value="registration.sport_discipline_id"/>
            <t t-set="share_url">https://muskathlon-kenya.ch/en_US<t t-esc="registration.website_url"/></t>
            <t t-set="share_content">Support me! <t t-esc="sport.page_title"/><t t-if="registration.compassion_event_id.country_id"> in <t t-esc="registration.compassion_event_id.country_id.name"/></t> - <t t-esc="registration.partner_display_name"/></t>
            <t t-set="image_url">https://muskathlon-kenya.ch/en_US/web/image/event.registration/<t t-esc="registration.id"/>/ambassador_picture_1</t>
            <t t-set="head">
                <meta property="og:title"  t-att-content="share_content" />
                <meta property="og:url"    t-att-content="share_url" />
                <meta property="og:description" t-att-content="registration.ambassador_quote"/>
                <meta property="og:image" t-att-content="image_url"/>
                <meta property="og:type" content="fitness.course"/>
            </t>
            <t t-call="website.layout">
                <!-- Facebook social share feature -->
                <div id="fb-root"></div>
                <script>(function(d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) return;
                    js = d.createElement(s); js.id = id;
                    js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v3.0";
                    fjs.parentNode.insertBefore(js, fjs);
                    }(document, 'script', 'facebook-jssdk'));
                </script>

                <div class="main_container" id="participants_details">
                    <div class="participant_image_container">
                        <div class="participant_image">
                            <h2 class="participant_image_text text-uppercase">Support <t t-esc="registration.partner_display_name"/></h2>
                        </div>
                    </div>
                    <div class="participant_details_container">
                        <!-- Include donation form -->
                        <t t-call="cms_form_compassion.modal_form"/>
                        <t t-set="title" t-value="registration.partner_display_name + ' | ' + event.name"/>
                        <div class="row">
                            <div class="col-sm-5">
                                <div class="card_container">
                                    <t t-if="not registration.ambassador_picture_2">
                                        <div class="position-relative">
                                            <img class="muskathlon_participant_image" t-attf-src="/web/image/event.registration/{{ registration.id }}/ambassador_picture_1">
                                                <t t-call="muskathlon.sport_icon"/>
                                            </img>
                                        </div>
                                    </t>
                                    <t t-else="">
                                        <div class="position-relative">
                                            <img class="muskathlon_participant_image" t-attf-src="/web/image/event.registration/{{registration.id}}/ambassador_picture_2">
                                                <t t-call="muskathlon.sport_icon"/>
                                            </img>
                                        </div>
                                    </t>
                                </div>
                                <div class="participant_details_buttons_container">
                                    <p class="center-text">
                                        <a href="#"
                                           class="btn btn-danger btn-muskathlon"
                                           data-toggle="modal"
                                           data-target="#modal_muskathlon_donation">
                                            Donate
                                        </a>
                                    </p>
                                    <p class="center-text">
                                        <a t-attf-href="https://{{ registration.host }}/parrainer-un-enfant/?eventId={{ event.id }}&amp;eventName={{ event.name }}&amp;registrationId={{ registration.id }}&amp;participantId={{ registration.partner_id_id }}&amp;participantName={{ registration.partner_name }}"
                                           class="btn btn-danger btn-muskathlon">
                                            Sponsor a child
                                        </a>
                                    </p>
                                </div>
                            </div>
                            <div class="col-sm-7">
                                <h2 class="side_title" t-field="sport.page_title"/>
                                Muskathlon :
                                <a t-attf-href="/event/{{ event.id }}" class="href_muskathlon">
                                    <t t-esc="event.name.replace('Muskathlon ', '')"/>
                                </a>
                                <p class="complete_name_container">
                                    <span class="text-uppercase complete_name" t-esc="registration.partner_display_name"/>
                                    <t t-esc="sport.sport.title()"/> for <t t-esc="sport.distance_km"/> km
                                </p>
                                <blockquote>
                                    <p t-field="registration.ambassador_quote"/>
                                </blockquote>
                                <!--<p t-field="registration.ambassador_description" class="ambassador_description"/>-->
                                <div class="space_top">
                                    Raised amount:
                                </div>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar"
                                         t-attf-aria-valuenow="{{ registration.amount_raised_percents }}"
                                         aria-valuemin="0"
                                         aria-valuemax="100"
                                         t-attf-style="width: {{ registration.amount_raised_percents }}%;">
                                    </div>
                                    <div class="progress-amount">
                                        <t t-esc="'{:n}'.format(registration.amount_raised).replace(',', '\'')"/> / <t t-esc="'{:n}'.format(registration.amount_objective).replace(',', '\'')"/> CHF
                                    </div>
                                </div>
                                <div class="social_share">
                                    <p>Share my project</p>
                                    <div class="fb-share-button" t-attf-data-href="{{share_url}}" data-layout="button_count"></div>
                                    <a class="twitter-share-button" t-attf-href="https://twitter.com/intent/tweet?text={{share_content}}&amp;url={{share_url}}&amp;hashtags=Muskathlon" target="new"><i class="fa fa-twitter"/></a>
                                </div>
                            </div>
                        </div>
                        <div>
                            <t t-call="muskathlon.footer_muskathlon"/>
                        </div>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>
