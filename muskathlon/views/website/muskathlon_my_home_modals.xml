<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <template id="modal_coordinates">
            <div class="modal fade" id="modal_change_coordinates" tabindex="-1"
                 role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">Coordinates
                            </h3>
                            <button type="button" class="close"
                                    data-dismiss="modal"
                                    aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="form_coordinates">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="row">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label" for="name">
                                            Your Name
                                        </label>
                                        <input type="text" name="name"
                                               class="form-control"
                                               t-att-value="name or partner.name"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label" for="email">
                                            Email
                                        </label>
                                        <input type="email" name="email"
                                               class="form-control"
                                               t-att-value="email or partner.email"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label" for="phone">
                                            Phone
                                        </label>
                                        <input type="tel" name="phone"
                                               class="form-control"
                                               t-att-value="phone or partner.phone"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label label-optional"
                                               for="street">Street
                                        </label>
                                        <input type="text" name="street"
                                               class="form-control"
                                               t-att-value="street or partner.street"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label" for="city">
                                            City
                                        </label>
                                        <input type="text" name="city"
                                               class="form-control"
                                               t-att-value="city or partner.city"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label" for="zipcode">
                                            Zip / Postal Code
                                        </label>
                                        <input type="text" name="zipcode"
                                               class="form-control"
                                               t-att-value="zipcode or partner.zip"/>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label"
                                               for="country_id">Country
                                        </label>
                                        <select name="country_id"
                                                class="form-control">
                                            <t t-foreach="countries or []"
                                               t-as="country">
                                                <option t-att-value="country.id"
                                                        t-att-selected="country.id == partner.country_id.id">
                                                    <t t-esc="country.name"/>
                                                </option>
                                            </t>
                                        </select>
                                    </div>
                                    <div t-attf-class="form-group col-lg-6">
                                        <label class="control-label label-optional"
                                               for="state_id">State / Province
                                        </label>
                                        <select name="state_id"
                                                class="form-control">
                                            <t t-foreach="states or []"
                                               t-as="state">
                                                <option t-att-value="state.id"
                                                        t-att-data-country_id="state.country_id.id"
                                                        t-att-selected="state.id == partner.state_id.id">
                                                    <t t-esc="state.name"/>
                                                </option>
                                            </t>
                                        </select>
                                        <!-- select states related to country -->
                                        <script>
                                            $(function() {
                                                var state_options = $("select[name='state_id']:enabled option:not(:first)");
                                                $('#form_coordinates').on('change', "select[name='country_id']", function() {
                                                    var select = $("select[name='state_id']");
                                                    state_options.detach();
                                                    var displayed_state = state_options.filter("[data-country_id=" + ($(this).val() || 0) + "]");
                                                    var nb = displayed_state.appendTo(select).show().size();
                                                    select.parent().toggle(nb >= 1);
                                                });
                                                $('#form_coordinates').find("select[name='country_id']").change();
                                            });
                                        </script>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default"
                                    data-dismiss="modal">Close
                            </button>
                            <button type="button" id="save_coordinates" class="btn btn-primary"
                                data-dismiss="modal">Save changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="modal_aboutme">
            <div class="modal fade" id="modal_change_aboutme" tabindex="-1"
                 role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">About me
                            </h3>
                            <button type="button" class="close"
                                    data-dismiss="modal"
                                    aria-label="Close">
                                <!--<span aria-hidden="true">&times;</span>-->
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="form_aboutme">
                                <div class="row">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    <div t-attf-class="form-group col-xs-12">
                                        <label class="control-label" for="description">
                                            Description
                                        </label>
                                        <textarea name="description" class="form-control"><t t-raw="partner.ambassador_details_id.description"/></textarea>
                                    </div>
                                    <div t-attf-class="form-group col-xs-12">
                                        <label class="control-label" for="quote">
                                            Quote
                                        </label>
                                        <textarea name="quote" class="form-control"><t t-raw="partner.ambassador_details_id.quote"/></textarea>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default"
                                    data-dismiss="modal">Close
                            </button>
                            <button type="button" id="save_aboutme" class="btn btn-primary" data-dismiss="modal">Save
                                changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="modal_settings">
            <div class="modal fade" id="modal_change_settings" tabindex="-1"
                 role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">Settings
                            </h3>
                            <button type="button" class="close"
                                    data-dismiss="modal"
                                    aria-label="Close">
                                <!--<span aria-hidden="true">&times;</span>-->
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="form_settings">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <div class="row">
                                    <div t-attf-class="form-group col-xs-12">
                                        <label class="control-label" for="mail_copy_when_donation">
                                            Mail copy when donation
                                        </label>
                                        <t t-if="partner.ambassador_details_id.mail_copy_when_donation">
                                            <input name="mail_copy_when_donation" type="checkbox" checked=""/>
                                        </t>
                                        <t t-if="not partner.ambassador_details_id.mail_copy_when_donation">
                                            <input name="mail_copy_when_donation" type="checkbox"/>
                                        </t>
                                        <p class="help-block">Select this if you want a copy for each mail sent to your donators.</p>
                                    </div>
                                    <div class="form-group col-xs-12">
                                        <label class="control-label" for="thank_you_quote">
                                            Thank you quote
                                        </label>
                                        <textarea name="thank_you_quote" class="form-control"><t t-esc="partner.ambassador_details_id.thank_you_quote"/></textarea>
                                        <!-- removes HTML tags from textarea -->
                                        <script>
                                            var textarea = document.querySelector('textarea[name="thank_you_quote"]');
                                            var temp = document.createElement('div');
                                            temp.innerHTML = textarea.value;
                                            textarea.value = temp.textContent;
                                        </script>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default"
                                    data-dismiss="modal">Close
                            </button>
                            <button type="button" id="save_settings" class="btn btn-primary" data-dismiss="modal">Save changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <template id="modal_tripinfos">
            <div class="modal fade" id="modal_change_tripinfos" tabindex="-1"
                 role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">Trip infos
                            </h3>
                            <button type="button" class="close"
                                    data-dismiss="modal"
                                    aria-label="Close">
                                <!--<span aria-hidden="true">&times;</span>-->
                            </button>
                        </div>
                        <div class="modal-body">
                            <form id="form_tripinfos">
                                <fieldset>
                                    <div class="row">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <div t-attf-class="form-group col-sm-6">
                                            <label class="control-label">
                                                T-shirt size
                                            </label>
                                            <select name="tshirt_size" class="form-control">
                                                <t t-foreach="tshirt" t-as="size">
                                                    <option t-att-value="size[0]"
                                                            t-att-selected="size[0] == partner.ambassador_details_id.tshirt_size">
                                                        <t t-esc="size[1]"/>
                                                    </option>
                                                </t>
                                            </select>
                                        </div>
                                        <div class="col-sm-6"/>
                                    </div>
                                </fieldset>
                                <fieldset>
                                    <legend>Emergency person</legend>
                                    <div class="row">
                                        <div t-attf-class="form-group col-xs-12">
                                            <label class="control-label" for="emergency_name">
                                                Name
                                            </label>
                                            <input class="form-control" type="text" name="emergency_name" t-att-value="partner.ambassador_details_id.emergency_name"/>
                                        </div>
                                        <div t-attf-class="form-group col-sm-6">
                                            <label class="control-label" for="emergency_phone">
                                                Phone
                                            </label>
                                            <input class="form-control" type="phone" name="emergency_phone" t-att-value="partner.ambassador_details_id.emergency_phone"/>
                                        </div>
                                        <div t-attf-class="form-group col-sm-6">
                                            <label class="control-label" for="emergency_relation_type">
                                                Relation type
                                            </label>
                                            <select name="emergency_relation_type" class="form-control">
                                                <t t-foreach="ert" t-as="type">
                                                    <option t-att-value="type[0]"
                                                            t-att-selected="type[0] == partner.ambassador_details_id.emergency_relation_type">
                                                        <t t-esc="type[1]"/>
                                                    </option>
                                                </t>
                                            </select>
                                        </div>
                                    </div>
                                </fieldset>
                                <fieldset>
                                    <legend>Passport</legend>
                                    <div class="row">
                                        <div t-attf-class="form-group col-xs-12">
                                            <label class="control-label" for="birth_name">
                                                Birth name
                                            </label>
                                            <input class="form-control" type="text" name="birth_name" t-att-value="partner.ambassador_details_id.birth_name"/>
                                        </div>
                                        <div t-attf-class="form-group col-sm-6">
                                            <label class="control-label" for="passport_number">
                                                Passport number
                                            </label>
                                            <input class="form-control" type="text" name="passport_number" t-att-value="partner.ambassador_details_id.passport_number"/>
                                        </div>
                                        <div t-attf-class="form-group col-sm-6">
                                            <label class="control-label" for="passport_expiration_date">
                                                Passport expiration date
                                            </label>
                                            <input class="form-control" type="text" name="passport_expiration_date" t-att-value="partner.ambassador_details_id.passport_expiration_date"/>
                                            <!-- adds datepicker to password expiration date field -->
                                            <script>
                                                $(function() {
                                                    $('input[name="passport_expiration_date"]').datepicker({ dateFormat: 'yy-mm-dd' });
                                                });
                                            </script>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default"
                                    data-dismiss="modal">Close
                            </button>
                            <button type="button" id="save_tripinfos" class="btn btn-primary" data-dismiss="modal">Save
                                changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </data>
</odoo>